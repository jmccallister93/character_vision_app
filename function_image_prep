import tensorflow as tf
def load_and_prep_images(filename, image_shape=224, scale=True):
  """
  Read in an image from file and turn it into a tensor and Reshapes
  the image to (224,224,3)

  Parameters:
  filename (str) = string filename of target image
  image_shape (int) = size to resize the target image to 
  scale (bool) = to scale pixel values to range (0,1)

  """
  #Read in image
  image = tf.io.read_file(filename)

  #Decode image to tensor
  image = tf.image.decode_jpeg(image)

  #Resize the image
  image = tf.image.resize(image, [image_shape, image_shape])

  #Rescale the image between 0 and 1
  if scale:
    return image/255.
  else:
    return image
